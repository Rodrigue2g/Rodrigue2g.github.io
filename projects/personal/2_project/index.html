<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> IoT Washing Machine Hardware Exploit Analysis | Rodrigue de Guerre </title> <meta name="author" content="Rodrigue de Guerre"> <meta name="description" content="A case study in bypassing centralized payment controller through logic-level and physical-layer vulnerabilities."> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?v=a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?v=f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?v=62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?v=591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8C%90&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?v=d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://rodrigue2g.github.io/projects/personal/2_project/"> <script src="/assets/js/theme.js?v=48c9b5bd7f2e0605e39e579400e22553"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?v=5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Rodrigue</span> de Guerre </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="fa-solid fa-magnifying-glass"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-half-sun-moon" id="light-toggle-system"></i> <i class="fa-solid fa-moon" id="light-toggle-dark"></i> <i class="fa-solid fa-sun" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">IoT Washing Machine Hardware Exploit Analysis</h1> <p class="post-description">A case study in bypassing centralized payment controller through logic-level and physical-layer vulnerabilities.</p> </header> <article> <h2 id="️-disclaimer">❗️ Disclaimer</h2> <p><em><strong>Ethical Conduct:</strong> This article is provided strictly for educational purposes and as a case study in embedded systems security. The researcher does not condone or encourage the unauthorized bypassing of payment systems or the tampering of utility hardware. In no mean should this be held accountable for the actions of someone trying to bypass such system.</em></p> <p><em><strong>Safety Warning:</strong> This project involves high-voltage alternative current (AC). Manipulating powered hardware carries a significant risk of electric shock, fire, or hazard. All physical analysis were conducted on de-energized hardware in a controlled environment.</em></p> <h2 id="project-overview">Project Overview</h2> <p>In modern residential complexes, you often find communal appliances (washing machines/dryers) connected via a centralized payment and control system. This research explores vulnerabilities in the communication protocol between a “Master Controller” and distributed “Appliance Nodes”, demonstrating how architectural oversights can lead to unauthorized service access.</p> <p>To frame this analysis, we define the objective: activating $n$ appliances, $n$ being as great as possible, with low overhead and high reproducability.</p> <p>The intended way to do unlock a washing machine is by entering your personal code in the Master Controller interface, which will let you unlock an available washer for a given price, fixed by the residence.</p> <p>To solve this game, one should first get an understanding of the system.</p> <h3 id="system-architecture">System Architecture</h3> <p>The environment consists of $n$ appliances connected (wireless) to a central Master Controller and each powered by a dedicated alimentation (with an accessible switch).</p> <ol> <li> <strong>Authentication:</strong> Users authenticate via a localized keypad or mobile API.</li> <li> <strong>Authorization:</strong> The Master Controller validates credentials (personal code) and available credits via a remote backend server (out of scope for this research).</li> <li> <strong>Actuation:</strong> Upon validation, the Master Controller sends a signal to a given “Appliance Node” (an MCU-controlled relay) to close the power circuit (basically a fancy conected switch). At the end of the laundry cycle, the Master node sends a Turn off signal to the Appliance Node.</li> </ol> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/personal_projects/vesta_architecture-480.webp 480w,/assets/img/personal_projects/vesta_architecture-800.webp 800w,/assets/img/personal_projects/vesta_architecture-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/personal_projects/vesta_architecture.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="System Architecture Overview" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> High-level architecture of the centralized controller communicating with distributed appliance units. </div> <p>In high-traffic residential laundry rooms, a common friction point occurs when a cycle completes and the user is not present to immediately retrieve their items. Once the paid session expires, the appliance deactivates, often leaving the electronic door latch engaged and the laundry inaccessible.</p> <p>While the appliances include a manual mechanical override to release the latch, it is often recessed within the chassis and inaccessible to the average user. To solve this UX challenge, the developers implemented a “Maintenance Unlock” feature. This software-driven bypass allows any user to trigger a 30-second power-up signal to an available machine, temporarily re-energizing the door latch for item retrieval.</p> <p>From a security perspective, this feature creates a transient privileged state. It assumes that 30 seconds of power is insufficient for a full laundry cycle, but as investigated in the following sections, this assumption fails to account for state-persistence errors during controller resets.</p> <p>With this overview in mind, we can move on to the exploit part.</p> <hr> <p><em>First, an obvious solution one could try, is brutforcing the code verification. But it could be time consuming based on the length of the code, a bit barbaric and not very fair to your neighbours, as it would imply using the account of someone else (whom may eventually find out, with increasing n).</em></p> <h2 id="vulnerability-1-state-sync-race-condition-logic-bypass">Vulnerability 1: State-Sync Race Condition (Logic Bypass)</h2> <p>Remember the system features a “maintenance unlock” intended to allow users to retrieve laundry if a cycle ends and the door remains locked. This feature triggers a 30-second power-on signal. Well what if you could prevent the main controller from sending this second turn off signal?</p> <p><strong>The Flaw:</strong> The “Turn Off” command is queued to fire 30 seconds after the “Turn On” command. If the Master Controller undergoes a hard reset immediately after the “Turn On” command is sent, the volatile memory clears the scheduled “Turn Off” instruction.</p> <p><strong>The Exploit:</strong> By triggering a hardware reset on the Master Controller during the 30-second window, the Appliance Node remains in a “latched” ON state. While the system attempts a corrective “Heartbeat” check every 10 minutes to sync states, this remains a viable window for unauthorized use.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/personal_projects/vesta_main_controller-480.webp 480w,/assets/img/personal_projects/vesta_main_controller-800.webp 800w,/assets/img/personal_projects/vesta_main_controller-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/personal_projects/vesta_main_controller.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Main Controller" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Illustration of a main controller. </div> <p>This is a first successfull solution to our “game”, but it lacks feasability with growing $n$, as you have to send all the “Unlock” commands and reset the Master node before the first 30 second time out (launched by the first Unlock).</p> <hr> <h2 id="vulnerability-2-hardware-actuation-bypass">Vulnerability 2: Hardware Actuation Bypass</h2> <p><em><strong>DISCLAIMER REMINDER</strong>: Manipulating high voltage hardware can be extremly dangerous and lead to fire or death. This is not an insentive to do so. One should never touch live cable and manipulate ee hadrware without proper knowledge and awarness of the risks!</em></p> <p>To find a more persistent and reliable exploit, a deep dive into the Appliance Node PCB was conducted.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/personal_projects/washer_controller_board.HEIC" sizes="95vw"></source> <img src="/assets/img/personal_projects/washer_controller_board.HEIC" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Controller PCB Inspection" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Internal view of the appliance controller PCB used for architectural analysis. </div> <p><strong>Analysis of the Actuator:</strong> The relay serves as the final gate for the high-voltage line. While the PCB includes a <strong>CSE187L-P current transformer</strong> for load monitoring, the primary switching is purely mechanical-magnetic.</p> <p>In the introduction, we mentioned that the washer controller was essentially a fancy connected switch. How did we come to this conlclusion? When you unlock a washer, you can here a very clear “click”, alike an elcetromagnet. This led us to look further into the washer’s controller After turing off the current and unpluging the the controller, we can have a closer look at it. As expected, we find a prominent <code class="language-plaintext highlighter-rouge">Finder 16A 250V Power relay</code>.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/personal_projects/F2452504-480.webp 480w,/assets/img/personal_projects/F2452504-800.webp 800w,/assets/img/personal_projects/F2452504-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/personal_projects/F2452504.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Finder 16A 250V Power relay" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Finder 16A 250V Power relay </div> <p><strong>The Hardware Exploit:</strong> Among the components we also find an <code class="language-plaintext highlighter-rouge">MRF24J40MD RF module</code> and an <code class="language-plaintext highlighter-rouge">STM32F302 MCU</code>, along with an AC/DC converter to power the board. A first thought could have been to simply plug the washer directly to the supply, but after carefull inspection the board, we found that it also regulates the power thanks to a <code class="language-plaintext highlighter-rouge">CSE187L-P current transformer</code>, so bypassing this might damage the washer or cause electircal hazards.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/personal_projects/vesta_power_supply.heic" sizes="95vw"></source> <img src="/assets/img/personal_projects/vesta_power_supply.heic" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Appliance Node Power Supply" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Appliance Node Power Supply </div> <p>During the visual inspection of the PCB, some jumpers were identified in proximity to the STM32F302 MCU. These likely serve as JTAG or SWD interfaces for factory programming. If it was indeed a JTAG interface, we could have probably dumped the firmware in order to find a triggarable bug, but this required working under live current condtition so we did not explore this further given the voltage levels and risk of haszards.</p> <p>A more coarse method is to focus on the power relay.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/personal_projects/power_relay_exploit.HEIC" sizes="95vw"></source> <img src="/assets/img/personal_projects/power_relay_exploit.HEIC" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Finder 16A 250V Power relay exploit" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Board's Finder 16A 250V Power relay with its cover off </div> <p>It is essentially a magnetic swicth, so by removing the plastic housing of the power relay (while de-energized), the “Normally Open” (NO) contact can be mechanically forced into a permanent “Closed” state by removing the return spring and securing the metallic strip to the connector. Upon re-assembly, the appliance bypasses the MCU’s logic entirely.</p> <hr> <p>This research serves as a case study in the security of centralized IoT appliance controllers. By analyzing the system through both software and hardware, we demonstrated that even systems with cloud-based authentication can be undermined if the local execution layer lacks state persistence or physical hardening.</p> <h2 id="security-recommendations">Security Recommendations</h2> <p>To harden the system against these vectors, the following improvements are recommended:</p> <ol> <li> <strong>State Persistence:</strong> Differentiate between Turn On command and Unlock command, and keep track of the time with an on-board timer to avoid relying on a turn off command that can be intercepted.</li> <li> <p><strong>Physical Integrity:</strong> Seal the chassis to avoid intrusions and lock the power switch to only let authorised personal turn off the current.</p> </li> <li> <strong>Synchronization:</strong> Increase the frequency of randomized polling between the Master and Node to ensure state alignment could be a solution but one could spoof the network in order to programatically intercept Turn off commands so this is not a reliable fix.</li> </ol> <p><em>The findings documented here are for educational and research purposes only. This analysis is intended to provide manufacturers and security engineers with data to improve the resilience of smart building infrastructure. The researcher does not condone the unauthorized use of services or the tampering of utility hardware.</em></p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Rodrigue de Guerre. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?v=a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?v=85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?v=2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?v=c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?v=c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?v=d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?v=a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?v=2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?v=f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?v=a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?v=6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?v=ccc841c459bfc0e64c1c2b5acd10df02"></script> </body> </html>